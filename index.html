<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AR Interativo - Cubo</title>

    <!-- Importando A-Frame e AR.js -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jeromeetienne/AR.js@1.7.2/aframe/build/aframe-ar.min.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">

    <!-- Cena de AR -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        <!-- Marcador para detectar AR -->
        <a-marker preset="hiro">
            <!-- Cubo Interativo -->
            <a-entity id="cubo" 
                      geometry="primitive: box; depth: 0.2; height: 0.2; width: 0.2" 
                      material="color: blue"
                      position="0 0 0"
                      scale="1 1 1"
                      rotation="0 0 0">
            </a-entity>
        </a-marker>

        <!-- C√¢mera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        let cubo = document.getElementById("cubo");
        let scale = 1;
        let isDragging = false;
        let isMoving = false;
        let lastX = 0, lastY = 0;
        let rotation = { x: 0, y: 0, z: 0 };
        let position = { x: 0, y: 0, z: 0 };
        let autoRotate = true; // Define se a rota√ß√£o autom√°tica est√° ativa

        // üé• MOVIMENTAR O CUBO NO AMBIENTE AR
        document.addEventListener("mousedown", (event) => {
            isDragging = true;
            lastX = event.clientX;
            lastY = event.clientY;
            autoRotate = false; // Para a rota√ß√£o autom√°tica ao interagir
        });

        document.addEventListener("mousemove", (event) => {
            if (!isDragging) return;

            let deltaX = (event.clientX - lastX) * 0.005;
            let deltaY = (event.clientY - lastY) * 0.005;

            if (event.shiftKey) { 
                // Se segurar Shift, move o cubo no ambiente
                position.x += deltaX;
                position.y -= deltaY;
                cubo.setAttribute("position", `${position.x} ${position.y} ${position.z}`);
                isMoving = true;
            } else {
                // Caso contr√°rio, rotaciona
                rotation.y += deltaX * 50;
                rotation.x -= deltaY * 50;
                cubo.setAttribute("rotation", `${rotation.x} ${rotation.y} ${rotation.z}`);
            }

            lastX = event.clientX;
            lastY = event.clientY;
        });

        document.addEventListener("mouseup", () => {
            isDragging = false;
            if (!isMoving) autoRotate = true;
            isMoving = false;
        });

        // üñ±Ô∏è ZOOM COM SCROLL DO MOUSE
        document.addEventListener("wheel", (event) => {
            scale += event.deltaY * -0.001;
            scale = Math.max(0.5, Math.min(2, scale)); // Limita entre 0.5 e 2
            cubo.setAttribute("scale", `${scale} ${scale} ${scale}`);
        });

        // üé® TOQUE PARA TROCAR COR DO CUBO
        cubo.addEventListener("click", () => {
            let corAtual = cubo.getAttribute("material").color;
            cubo.setAttribute("material", "color", corAtual === "blue" ? "red" : "blue");
        });

        // üîÑ ROTA√á√ÉO AUTOM√ÅTICA QUANDO N√ÉO ESTIVER INTERAGINDO
        function animateRotation() {
            if (autoRotate) {
                rotation.y += 1;
                cubo.setAttribute("rotation", `${rotation.x} ${rotation.y} ${rotation.z}`);
            }
            requestAnimationFrame(animateRotation);
        }
        animateRotation();

    </script>

</body>
</html>
